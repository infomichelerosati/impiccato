<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gioco dell'Impiccato</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 0.5rem;
        }
        .container {
            max-width: 95%;
            width: 600px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 98vh; /* Use min-height to ensure content fills the screen */
        }
        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex-grow: 1;
        }
        .word-display-container {
            display: flex;
            justify-content: center;
            flex-wrap: nowrap;
            overflow-x: auto;
            white-space: nowrap;
            padding: 0 0.5rem;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .word-display-container::-webkit-scrollbar {
            display: none;
        }
        .letter-char {
            font-weight: 800;
            color: #1f2937;
            transition: all 0.3s ease;
        }
        .keyboard-button {
            transition: all 0.2s;
            transform: scale(1);
        }
        .keyboard-button:hover:not(:disabled) {
            transform: scale(1.05);
            background-color: #fcd34d;
        }
        .keyboard-button:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }
        .keyboard-button.correct {
            background-color: #86efac;
            color: #166534;
            opacity: 1;
        }
        .keyboard-button.incorrect {
            background-color: #fca5a5;
            color: #991b1b;
            opacity: 1;
        }
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            padding: 1rem;
        }
        .popup-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 500px;
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="container bg-white p-6 md:p-8 rounded-2xl shadow-xl">
        <div class="main-content">
            <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800 mb-2">Gioco dell'Impiccato</h1>
            <p class="text-gray-500 mb-4 text-sm md:text-base">Indovina la parola prima di esaurire i tentativi!</p>

            <!-- Scoreboard -->
            <div class="flex justify-around w-full mb-4 text-lg md:text-xl font-semibold">
                <span class="text-green-600">Punti: <span id="score">0</span></span>
                <span class="text-red-600">Sconfitte: <span id="losses-count">0</span></span>
            </div>

            <!-- Hangman Image/Drawing Container -->
            <div id="hangman-container" class="bg-gray-200 p-2 rounded-xl mb-4 w-40 h-40 flex items-center justify-center shadow-inner">
                <svg id="hangman-drawing" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="w-full h-auto text-gray-700">
                    <g id="gallows" stroke="currentColor" stroke-width="4" stroke-linecap="round">
                        <line x1="10" y1="95" x2="90" y2="95"/>
                        <line x1="20" y1="95" x2="20" y2="10"/>
                        <line x1="20" y1="10" x2="60" y2="10"/>
                        <line x1="60" y1="10" x2="60" y2="20"/>
                    </g>
                    <g id="body-parts" stroke="currentColor" stroke-width="4" stroke-linecap="round" fill="none" visibility="hidden">
                        <circle id="head" cx="60" cy="30" r="10" stroke="currentColor" stroke-width="4" fill="none"/>
                        <line id="torso" x1="60" y1="40" x2="60" y2="60"/>
                        <line id="left-arm" x1="60" y1="45" x2="50" y2="55"/>
                        <line id="right-arm" x1="60" y1="45" x2="70" y2="55"/>
                        <line id="left-leg" x1="60" y1="60" x2="55" y2="75"/>
                        <line id="right-leg" x1="60" y1="60" x2="65" y2="75"/>
                    </g>
                </svg>
            </div>

            <!-- Word Display Container -->
            <div id="game-word-container" class="mb-4 w-full px-1 word-display-container">
                <!-- Letters will be generated by JS -->
            </div>

            <!-- Message and New Game Button Container -->
            <div id="message-container" class="h-10 mb-4 text-sm md:text-base font-semibold min-h-[2.5rem]">
                <p id="game-message" class="text-gray-700"></p>
            </div>
        </div>

        <div class="footer-content mt-auto">
            <!-- Keyboard Buttons Container -->
            <div id="keyboard-container" class="grid grid-cols-7 sm:grid-cols-9 md:grid-cols-10 gap-1 mb-4 w-full">
                <!-- Buttons will be generated by JavaScript -->
            </div>

            <!-- New Game Button -->
            <button id="new-game-button" class="bg-yellow-400 text-yellow-900 font-bold py-2 px-4 rounded-full shadow-lg hover:bg-yellow-500 transform hover:scale-105 transition-transform duration-200 w-full md:w-auto">
                Nuova Partita
            </button>
        </div>
    </div>

    <!-- Popup for Word Description -->
    <div id="popup-overlay" class="popup-overlay hidden">
        <div class="popup-content">
            <h2 id="popup-title" class="text-xl md:text-2xl font-bold mb-4"></h2>
            <p id="popup-message" class="text-sm md:text-base text-gray-700 mb-6"></p>
            <button id="close-popup-button" class="bg-blue-500 text-white font-bold py-2 px-6 rounded-full shadow-lg hover:bg-blue-600 transition-colors duration-200">
                Chiudi
            </button>
        </div>
    </div>

    <script>
        // Game state and variables
        const words = [
            "antropomorfismo", "biodiversità", "circostanze", "conseguenze",
            "contraddistinguono", "cosmopolita", "democrazia", "disorientamento",
            "elettroencefalografia", "filantropia", "giurisprudenza",
            "inconscio", "infrastruttura", "irreversibile", "metamorfosi",
            "microbiologia", "multiculturalismo", "neuroscienza", "onomatopeico",
            "paracadutismo", "perennemente", "rinascimento", "responsabilità",
            "stratificazione", "sostenibilità", "telecomunicazioni", "trasformazione",
            "accondiscendenza", "anticonformista", "caratterizzazione",
            "concomitanza", "contemporaneamente", "contrapposizione",
            "estemporaneo", "eterogeneità", "fenomenologia", "giustapposizione",
            "inconsapevolmente", "interdisciplinare", "introspezione",
            "irrazionalità", "onnicomprensivo", "paragonabile", "plausibilità",
            "prospettiva", "psicoanalisi", "rappresentazione", "reciprocità",
            "sintetizzazione", "sovrastimare", "trasgressione", "universalismo",
            "valutazione", "vulnerabilità", "zeppolamento", "zoccolatura",
            "sostenibilita", "preliminarmente", "interconnessione", "interpretazione"
        ];
        
        const wordDescriptions = {
            "ANTROPOMORFISMO": "L'attribuzione di caratteristiche umane a esseri non umani o a cose inanimate.",
            "BIODIVERSITÀ": "La varietà di organismi viventi, di specie e di ecosistemi.",
            "CIRCOSTANZE": "Gli eventi o le condizioni che accompagnano un fatto.",
            "CONSEGUENZE": "Gli effetti, le ripercussioni di un'azione o di un evento.",
            "CONTRADDISTINGUONO": "Verbo che indica un tratto distintivo o una caratteristica che differenzia qualcosa.",
            "COSMOPOLITA": "Cittadino del mondo; persona che non ha pregiudizi legati alla propria nazionalità.",
            "DEMOCRAZIA": "Sistema di governo in cui il potere appartiene al popolo.",
            "DISORIENTAMENTO": "Perdita del senso dell'orientamento o stato di confusione mentale.",
            "ELETTROENCEFALOGRAFIA": "Tecnica che registra l'attività elettrica del cervello.",
            "FILANTROPIA": "Amore per l'umanità, che si manifesta con azioni di aiuto concreto.",
            "GIURISPRUDENZA": "L'insieme delle sentenze dei tribunali o la scienza del diritto.",
            "INCONSCIO": "La parte della mente che non è direttamente accessibile alla coscienza.",
            "INFRASTRUTTURA": "L'insieme delle strutture e dei servizi di base necessari per il funzionamento di una società.",
            "IRREVERSIBILE": "Che non può tornare indietro, non modificabile.",
            "METAMORFOSI": "Processo di trasformazione profonda di un essere vivente o di una cosa.",
            "MICROBIOLOGIA": "La scienza che studia i microrganismi.",
            "MULTICULTURALISMO": "Coesistenza di diverse culture all'interno di una stessa società.",
            "NEUROSCIENZA": "La scienza che studia il sistema nervoso e il cervello.",
            "ONOMATOPEICO": "Che riproduce suoni o rumori naturali.",
            "PARACADUTISMO": "Lo sport di lanciarsi con il paracadute da un aereo.",
            "PERENNEMENTE": "In modo continuativo, per sempre.",
            "RINASCIMENTO": "Importante periodo storico di rinascita artistica e culturale in Europa.",
            "RESPONSABILITÀ": "Il dovere di rispondere delle proprie azioni.",
            "STRATIFICAZIONE": "Disposizione in strati o livelli.",
            "SOSTENIBILITÀ": "La capacità di mantenere un processo o una condizione nel tempo.",
            "TELECOMUNICAZIONI": "Il processo di comunicazione a distanza tramite tecnologie elettroniche.",
            "TRASFORMAZIONE": "Il processo di cambiare forma o natura.",
            "ACCONDISCENDENZA": "Atteggiamento di chi si adatta facilmente alla volontà altrui.",
            "ANTICONFORMISTA": "Chi rifiuta le convenzioni sociali e le regole stabilite.",
            "CARATTERIZZAZIONE": "L'atto di definire i tratti distintivi di qualcosa o qualcuno.",
            "CONCOMITANZA": "La simultaneità di due o più eventi.",
            "CONTEMPORANEAMENTE": "Nello stesso momento.",
            "CONTRAPPOSIZIONE": "Stato di conflitto o di contrasto tra due elementi.",
            "ESTEMPORANEO": "Che viene fatto o detto sul momento, senza preparazione.",
            "ETEROGENEITÀ": "Caratteristica di essere composto da elementi diversi.",
            "FENOMENOLOGIA": "Lo studio dei fenomeni così come si manifestano alla coscienza.",
            "GIUSTAPPOSIZIONE": "L'atto di mettere due cose vicine, senza mescolarle.",
            "INCONSAPEVOLMENTE": "Senza esserne coscienti.",
            "INTERDISCIPLINARE": "Che coinvolge due o più discipline scientifiche o accademiche.",
            "INTROSPEZIONE": "Analisi interiore dei propri stati d'animo.",
            "IRRAZIONALITÀ": "La qualità di essere contrario alla ragione.",
            "ONNICOMPRENSIVO": "Che comprende ogni cosa.",
            "PARAGONABILE": "Che può essere messo a confronto con un'altra cosa.",
            "PLAUSIBILITÀ": "La qualità di essere verosimile o credibile.",
            "PROSPETTIVA": "Punto di vista o modo di vedere le cose.",
            "PSICOANALISI": "Metodo di indagine psicologica fondato da Freud.",
            "RAPPRESENTAZIONE": "L'azione di rendere presente qualcosa.",
            "RECIPROCITÀ": "Corrispondenza di un'azione o un sentimento.",
            "SINTETIZZAZIONE": "L'atto di riassumere o ridurre ai punti essenziali.",
            "SOVRASTIMARE": "Valutare in modo eccessivo qualcosa.",
            "TRASGRESSIONE": "Violazione di una regola o di una legge.",
            "UNIVERSALISMO": "Dottrina che tende all'unità e alla comprensione generale.",
            "VALUTAZIONE": "L'atto di dare un giudizio o un valore.",
            "VULNERABILITÀ": "La condizione di essere esposti a danni o pericoli.",
            "ZEPPOLAMENTO": "In linguistica, difetto di pronuncia che consiste nel parlare con la zeppola.",
            "ZOCCOLATURA": "La parte inferiore di un edificio, o la decorazione alla base di un muro.",
            "SOSTENIBILITA": "Capacità di mantenere un processo in equilibrio nel tempo.",
            "PRELIMINARMENTE": "In via preliminare, in anticipo.",
            "INTERCONNESSIONE": "Collegamento reciproco tra più elementi.",
            "INTERPRETAZIONE": "L'atto di dare un significato o una spiegazione."
        };
        
        const bodyParts = ['head', 'torso', 'left-arm', 'right-arm', 'left-leg', 'right-leg'];

        let secretWord = '';
        let guessedLetters = new Set();
        let incorrectGuesses = 0;
        const maxIncorrectGuesses = bodyParts.length;

        // Score
        let score = 0;
        let losses = 0;

        // DOM elements
        const hangmanDrawingEl = document.getElementById('hangman-drawing');
        const gameWordContainer = document.getElementById('game-word-container');
        const keyboardContainer = document.getElementById('keyboard-container');
        const gameMessageEl = document.getElementById('game-message');
        const newGameButton = document.getElementById('new-game-button');
        const scoreEl = document.getElementById('score');
        const lossesCountEl = document.getElementById('losses-count');

        const popupOverlay = document.getElementById('popup-overlay');
        const popupTitle = document.getElementById('popup-title');
        const popupMessage = document.getElementById('popup-message');
        const closePopupButton = document.getElementById('close-popup-button');

        /**
         * Normalizes a string by converting it to uppercase and removing accents.
         * @param {string} str - The input string.
         * @returns {string} The normalized string.
         */
        function normalizeString(str) {
            return str.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        /**
         * Initializes a new game.
         */
        function initGame() {
            // Reset game state
            secretWord = words[Math.floor(Math.random() * words.length)];
            guessedLetters.clear();
            incorrectGuesses = 0;
            gameMessageEl.textContent = '';
            gameMessageEl.className = 'text-gray-700'; // Reset color

            // Hide body parts
            bodyParts.forEach(part => {
                document.getElementById(part).style.visibility = 'hidden';
            });

            // Reset keyboard buttons
            keyboardContainer.innerHTML = '';
            for (let i = 65; i <= 90; i++) {
                const letter = String.fromCharCode(i);
                const button = document.createElement('button');
                button.textContent = letter;
                button.classList.add(
                    'keyboard-button',
                    'bg-gray-200',
                    'text-gray-800',
                    'font-semibold',
                    'rounded-lg',
                    'p-1',
                    'h-8',
                    'w-8',
                    'flex',
                    'items-center',
                    'justify-center',
                    'shadow-md',
                    'hover:shadow-lg',
                    'md:p-2',
                    'md:h-10',
                    'md:w-10'
                );
                button.addEventListener('click', () => handleGuess(letter));
                keyboardContainer.appendChild(button);
            }
            
            updateDisplay();
            popupOverlay.classList.add('hidden');
        }

        /**
         * Updates the word display.
         */
        function updateDisplay() {
            gameWordContainer.innerHTML = '';
            
            const baseFontSize = 4; // Desired font size in rem
            const baseLetterSpacing = 0.4; // Desired letter spacing in rem
            
            // Dynamic font size and letter spacing based on word length
            const wordLength = secretWord.length;
            const containerWidth = gameWordContainer.getBoundingClientRect().width;
            
            const initialWidth = wordLength * (baseFontSize * 16) + (wordLength - 1) * (baseLetterSpacing * 16);

            let scaleFactor = 1;
            if (initialWidth > containerWidth) {
                scaleFactor = containerWidth / initialWidth;
            }

            const finalFontSize = baseFontSize * scaleFactor;
            const finalLetterSpacing = baseLetterSpacing * scaleFactor;

            for (const letter of secretWord) {
                const normalizedLetter = normalizeString(letter);
                const isGuessed = guessedLetters.has(normalizedLetter);
                
                const letterSpan = document.createElement('span');
                letterSpan.textContent = isGuessed ? letter.toUpperCase() : '_';
                letterSpan.style.fontSize = `${finalFontSize}rem`;
                letterSpan.style.letterSpacing = `${finalLetterSpacing}rem`;
                letterSpan.classList.add('letter-char');
                gameWordContainer.appendChild(letterSpan);
            }
        }

        /**
         * Handles a letter guess from the user.
         * @param {string} letter - The letter guessed by the user.
         */
        function handleGuess(letter) {
            const normalizedLetter = normalizeString(letter);
            if (guessedLetters.has(normalizedLetter)) {
                return;
            }

            guessedLetters.add(normalizedLetter);

            const button = Array.from(keyboardContainer.children).find(btn => btn.textContent === letter);
            if(button) {
                button.disabled = true;
            }

            const normalizedSecretWord = normalizeString(secretWord);
            const letterInWord = normalizedSecretWord.includes(normalizedLetter);
            
            if (letterInWord) {
                if(button) {
                    button.classList.add('correct');
                }
                updateDisplay();

                let won = true;
                for(const char of normalizedSecretWord){
                    if(!guessedLetters.has(char)){
                        won = false;
                        break;
                    }
                }

                if (won) {
                    let roundScore = 0;
                    if (incorrectGuesses === 0) {
                        roundScore = 10;
                    } else if (incorrectGuesses === 1) {
                        roundScore = 8;
                    } else if (incorrectGuesses === 2) {
                        roundScore = 6;
                    } else {
                        roundScore = 5;
                    }
                    score += roundScore;
                    scoreEl.textContent = score;

                    showPopup("Hai vinto!", `La parola era "${secretWord.toUpperCase()}".<br><br>Significato: ${wordDescriptions[normalizeString(secretWord)] || "Nessuna descrizione disponibile."}`);
                    endGame();
                }
            } else {
                if (incorrectGuesses < maxIncorrectGuesses) {
                    document.getElementById(bodyParts[incorrectGuesses]).style.visibility = 'visible';
                }
                incorrectGuesses++;
                if(button) {
                    button.classList.add('incorrect');
                }

                if (incorrectGuesses >= maxIncorrectGuesses) {
                    losses++;
                    lossesCountEl.textContent = losses;
                    showPopup("Hai perso!", `La parola era "${secretWord.toUpperCase()}".<br><br>Significato: ${wordDescriptions[normalizeString(secretWord)] || "Nessuna descrizione disponibile."}`);
                    endGame();
                }
            }
        }

        /**
         * Ends the game by disabling all letter buttons.
         */
        function endGame() {
            Array.from(keyboardContainer.children).forEach(button => {
                button.disabled = true;
            });
        }
        
        /**
         * Displays the popup with the given title and message.
         * @param {string} title - The title of the popup.
         * @param {string} message - The message to display.
         */
        function showPopup(title, message) {
            popupTitle.textContent = title;
            popupMessage.innerHTML = message;
            popupOverlay.classList.remove('hidden');
        }

        // Event listeners
        newGameButton.addEventListener('click', initGame);
        window.addEventListener('resize', updateDisplay);
        closePopupButton.addEventListener('click', () => {
            popupOverlay.classList.add('hidden');
        });

        // Start the game on window load
        window.onload = function() {
            initGame();
        };

    </script>
</body>
</html>

